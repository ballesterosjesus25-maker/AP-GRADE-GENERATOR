<!doctype html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>DepEd Grade Calculator</title>
  <style>
    :root{--blue:#0b61a4;--light:#eaf6ff;--muted:#666}
    *{box-sizing:border-box}
    body{font-family:Inter, Roboto, Arial, sans-serif;background:#f3f6fb;margin:0;padding:18px}
    .container{max-width:760px;margin:0 auto}
    header{display:flex;gap:12px;align-items:center;margin-bottom:10px}
    header img{height:44px}
    h1{font-size:20px;margin:0;color:var(--blue)}
    p.lead{margin:6px 0 18px;color:var(--muted)}

    .card{background:white;border-radius:12px;padding:14px;margin-bottom:12px;box-shadow:0 6px 18px rgba(11,97,164,0.06)}
    .card h2{margin:0 0 8px;font-size:16px;color:var(--blue)}
    label{display:block;font-size:13px;margin-bottom:6px;color:#333}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    input[type=number], input[type=text]{padding:10px;border-radius:8px;border:1px solid #d6e6f6;width:100%}
    input[readonly]{background:var(--light);border:1px solid #cfe9ff;font-weight:700;cursor:not-allowed}
    .highlight{background:var(--light);font-weight:700}
    .remark{font-weight:800}
    .passed{color:#0b7a3d}
    .failed{color:#c92a2a}
    button{background:var(--blue);color:white;padding:10px 12px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
    button.ghost{background:transparent;color:var(--blue);border:2px solid var(--blue)}
    small.note{display:block;color:var(--muted);margin-top:6px}
    footer{display:flex;gap:8px;align-items:center;justify-content:center;margin-top:12px}

    @media(min-width:720px){ .row-2{display:flex;gap:10px} .row-2 > div{flex:1} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="data:image/svg+xml;utf8,&lt;svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;rect width='100' height='100' fill='%230b61a4'/&gt;&lt;text x='50' y='56' font-size='40' font-family='Arial' fill='white' text-anchor='middle'&gt;ED&lt;/text&gt;&lt;/svg&gt;" alt="logo">
      <div>
        <h1>DepEd Grade Calculator</h1>
        <p class="lead">Simple mobile-friendly grade calculator — Written, Performance, Quarterly.</p>
      </div>
    </header>

    <!-- WRITTEN TASKS -->
    <section class="card">
      <h2>Written Tasks</h2>
      <div class="row-2">
        <div>
          <label>Cell O10 — Total Items (Max points)</label>
          <input id="written_total_items" type="number" min="0" placeholder="e.g. 50">
        </div>
        <div>
          <label>Cell O12 — Total Score</label>
          <input id="written_total_score_input" type="number" min="0" placeholder="e.g. 45">
        </div>
      </div>

      <div style="margin-top:10px" class="row">
        <div style="flex:1">
          <label>Cell P12 — Percentage</label>
          <input id="written_percentage" type="text" readonly="" class="highlight">
        </div>
        <div style="flex:1">
          <label>Cell Q12 — Weighted Average (30%)</label>
          <input id="written_weighted" type="text" readonly="" class="highlight">
        </div>
      </div>

      <div style="margin-top:10px" class="row">
        <div style="flex:1">
          <label>Remarks</label>
          <input id="written_remarks" type="text" readonly="" class="remark">
        </div>
      </div>
    </section>

    <!-- PERFORMANCE TASKS -->
    <section class="card">
      <h2>Performance Tasks</h2>
      <div class="row-2">
        <div>
          <label>Cell AB10 — Total Items (Max points)</label>
          <input id="perf_total_items" type="number" min="0" placeholder="e.g. 50">
        </div>
        <div>
          <label>Cell AB12 — Total Score</label>
          <input id="perf_total_score_input" type="number" min="0" placeholder="e.g. 40">
        </div>
      </div>

      <div style="margin-top:10px" class="row">
        <div style="flex:1">
          <label>Cell AC12 — Percentage</label>
          <input id="perf_percentage" type="text" readonly="" class="highlight">
        </div>
        <div style="flex:1">
          <label>Cell AD12 — Weighted Percentage (50%)</label>
          <input id="perf_weighted" type="text" readonly="" class="highlight">
        </div>
      </div>

      <div style="margin-top:10px" class="row">
        <div style="flex:1">
          <label>Remarks</label>
          <input id="perf_remarks" type="text" readonly="" class="remark">
        </div>
      </div>
    </section>

    <!-- QUARTERLY EXAM -->
    <section class="card">
      <h2>Quarterly Exam</h2>
      <div class="row-2">
        <div>
          <label>Cell AE10 — Total Items (Max points)</label>
          <input id="exam_total_items" type="number" min="0" placeholder="e.g. 50">
        </div>
        <div>
          <label>Cell AE12 — Total Score</label>
          <input id="exam_total_score" type="number" min="0" placeholder="e.g. 45">
        </div>
      </div>

      <div style="margin-top:10px" class="row">
        <div style="flex:1">
          <label>Cell AF12 — Percentage</label>
          <input id="exam_percentage" type="text" readonly="" class="highlight">
        </div>
        <div style="flex:1">
          <label>Cell AG12 — Weighted Percentage (20%)</label>
          <input id="exam_weighted" type="text" readonly="" class="highlight">
        </div>
      </div>

      <div style="margin-top:10px" class="row">
        <div style="flex:1">
          <label>Remarks</label>
          <input id="exam_remarks" type="text" readonly="" class="remark">
        </div>
      </div>
    </section>

    <!-- FINAL GRADE -->
    <section class="card">
      <h2>Final Grade</h2>
      <div style="margin-bottom:10px" class="row">
        <div style="flex:1">
          <label>Cell AH12 — Initial Grade</label>
          <input id="initial_grade" type="text" readonly="" class="highlight">
        </div>
        <div style="flex:1">
          <label>Cell AI12 — Final Grade</label>
          <input id="final_grade" type="text" readonly="" class="highlight">
        </div>
      </div>
      <div class="row">
        <div style="flex:1">
          <label>Remarks (Final)</label>
          <input id="final_remarks" type="text" readonly="" class="remark">
        </div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
        <button id="computeFinal">Compute Final Grade</button>
        <button id="downloadBtn" class="ghost">Download HTML</button>
      </div>
    </section>

    <footer>
      <small class="note">All calculations run locally in your browser. No data is uploaded to servers.</small>
    </footer>
  </div>

  <script>
    const $ = id => document.getElementById(id);
    function safeRound(v,d){ if(!isFinite(v)) return NaN; const f=Math.pow(10,d); return Math.round((v+Number.EPSILON)*f)/f; }
    function parseNumber(v){ const n=Number(v); return (isFinite(n) && !isNaN(n)) ? n : NaN; }

    function computeWritten(){
      const items = parseNumber($('written_total_items').value);
      const score = parseNumber($('written_total_score_input').value);
      if(!isNaN(score)) $('written_total_score_input').value = score;
      if(!isNaN(items) && items>0 && !isNaN(score)){
        const pct = safeRound((score / items) * 100,2);
        $('written_percentage').value = pct.toFixed(2) + '%';
        $('written_weighted').value = safeRound(pct * 0.3,2);
        const remark = pct >= 60 ? 'PASSED' : 'FAILED';
        $('written_remarks').value = remark; $('written_remarks').className = 'remark ' + (remark==='PASSED'? 'passed':'failed');
      } else { $('written_percentage').value=''; $('written_weighted').value=''; $('written_remarks').value=''; $('written_remarks').className='remark'; }
      // clear final until recompute
      $('initial_grade').value=''; $('final_grade').value=''; $('final_remarks').value=''; $('final_remarks').className='remark';
    }

    function computePerf(){
      const items = parseNumber($('perf_total_items').value);
      const score = parseNumber($('perf_total_score_input').value);
      if(!isNaN(score)) $('perf_total_score_input').value = score;
      if(!isNaN(items) && items>0 && !isNaN(score)){
        const pct = safeRound((score / items) * 100,2);
        $('perf_percentage').value = pct.toFixed(2) + '%';
        $('perf_weighted').value = safeRound(pct * 0.5,2);
        const remark = pct >= 60 ? 'PASSED' : 'FAILED';
        $('perf_remarks').value = remark; $('perf_remarks').className = 'remark ' + (remark==='PASSED'? 'passed':'failed');
      } else { $('perf_percentage').value=''; $('perf_weighted').value=''; $('perf_remarks').value=''; $('perf_remarks').className='remark'; }
      $('initial_grade').value=''; $('final_grade').value=''; $('final_remarks').value=''; $('final_remarks').className='remark';
    }

    function computeExam(){
      const items = parseNumber($('exam_total_items').value);
      const score = parseNumber($('exam_total_score').value);
      if(!isNaN(score)) $('exam_total_score').value = score;
      if(!isNaN(items) && items>0 && !isNaN(score)){
        const pct = safeRound((score / items) * 100,2);
        $('exam_percentage').value = pct.toFixed(2) + '%';
        $('exam_weighted').value = safeRound(pct * 0.2,2);
        const remark = pct >= 60 ? 'PASSED' : 'FAILED';
        $('exam_remarks').value = remark; $('exam_remarks').className = 'remark ' + (remark==='PASSED'? 'passed':'failed');
      } else { $('exam_percentage').value=''; $('exam_weighted').value=''; $('exam_remarks').value=''; $('exam_remarks').className='remark'; }
      $('initial_grade').value=''; $('final_grade').value=''; $('final_remarks').value=''; $('final_remarks').className='remark';
    }

    $('written_total_items').addEventListener('input', computeWritten);
    $('written_total_score_input').addEventListener('input', computeWritten);
    $('perf_total_items').addEventListener('input', computePerf);
    $('perf_total_score_input').addEventListener('input', computePerf);
    $('exam_total_items').addEventListener('input', computeExam);
    $('exam_total_score').addEventListener('input', computeExam);

    $('computeFinal').addEventListener('click', ()=>{
      const w = parseNumber($('written_weighted').value) || 0;
      const p = parseNumber($('perf_weighted').value) || 0;
      const e = parseNumber($('exam_weighted').value) || 0;
      const initial = safeRound(w + p + e,2);
      $('initial_grade').value = initial.toFixed(2);
      let final = '';
      if(!isNaN(initial)){
        if(initial >= 60) final = Math.floor(((initial - 60) / 1.6) + 75);
        else final = Math.floor((initial / 4) + 60);
        $('final_grade').value = final;
        const remark = final >= 75 ? 'PASSED' : 'FAILED';
        $('final_remarks').value = remark; $('final_remarks').className = 'remark ' + (remark==='PASSED'? 'passed':'failed');
      }
      $('final_grade').scrollIntoView({behavior:'smooth', block:'center'});
    });

    // Download HTML
    $('downloadBtn').addEventListener('click', ()=>{
      const doc = '<!doctype html>\n' + document.documentElement.outerHTML;
      const blob = new Blob([doc], {type: 'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'deped_grade_calculator.html'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // initial focus
    window.addEventListener('load', ()=>{ $('written_total_items').focus(); });
  </script>

</body></html>